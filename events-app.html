<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <title>Reactive integration with Events API</title>
    <link type="text/css" rel="stylesheet" href="assets/css/github-markdown.css">
    <link type="text/css" rel="stylesheet" href="assets/css/pilcrow.css">
    <link type="text/css" rel="stylesheet" href="assets/css/hljs-github.min.css" />
    <link type="text/css" rel="stylesheet" href="assets/css/main.css" />
</head>

<body data-title="Reactive integration with Events API">
    <div class="wrapper">
        <div class="egnyte-branding">
            <div class="nav">

            </div>
        </div>
        <div class="nav">
            <a href="index.html" class="back-to-main">&#11188; Back to Table of Contents</a>
        </div>
        <article class="markdown-body"><h1 id="reactive-integration-with-events-api"><a class="header-link" href="#reactive-integration-with-events-api"></a>Reactive integration with Events API</h1>
<h2 id="introduction"><a class="header-link" href="#introduction"></a>Introduction</h2>
<p>Egnyte Connect stores the files, while the ecosystem of apps and integrations lets users manipulate the files in more ways than a single platform could. Some integrations will need to know when a file got updated or when folder contents change.</p>
<h3 id="use-this-recipe-if-you:"><a class="header-link" href="#use-this-recipe-if-you:"></a>Use this recipe if you:</h3>
<ul class="list">
<li>want to map some structures inside your product to specific folders in Egnyte and keep the functionality up to date for new files showing up</li>
<li>want to detect new files/versions being uploaded to scan them or perform various kinds of automation</li>
</ul>
<p>This recipe could pair well with:</p>
<ul class="list">
<li><a href="./external-storage.html">External Storage Provider</a></li>
<li><a href="./elaborate-uint.html">Elaborate context menu action</a></li>
<li>A glass of white wine</li>
</ul>
<h2 id="ingredients"><a class="header-link" href="#ingredients"></a>Ingredients</h2>
<ul class="list">
<li>Two tablespoons of understanding: <a href="./definitions.html">Egnyte-specific terms</a></li>
<li><a href="./auth.html">Authentication</a></li>
<li><a href="https://developers.egnyte.com/docs/read/Events_API">Public API Events</a><ul class="list">
<li>getting latest events by ids</li>
<li>suppressing events generated by your own app</li>
</ul>
</li>
<li><a href="https://developers.egnyte.com/docs/read/File_System_Management_API_Documentation">Public API for file system</a> to perform actions in reaction to events</li>
<li>Our <a href="https://developers.egnyte.com/Egnyte_SDK">SDKs</a> support events (optional)</li>
</ul>
<h2 id="steps"><a class="header-link" href="#steps"></a>Steps</h2>
<p>Events API provides means to implement a synchronization service that would duplicate content from Egnyte to a different service. <strong>Don&#39;t try to implement general synchronization</strong> between your service&#39;s permanent cloud storage and Egnyte. You can try to keep copies of files from a specific folder for limited time if your service benefits from that, but anything more is not recommended.</p>
<p>It always turns out to be much more complicated than initially estimated. And some customers won&#39;t be able to use your integration if their company&#39;s data governance policy is strict.</p>
<ol class="list">
<li>Implement Auth - use the Enhanced Auth Service to receive OAuth2 code and exchange it for a token.</li>
<li>Decide if you want to use one &quot;Admin&quot; token for all interactions or let every user get authenticated separately. We suggest you do your best to choose the latter - API request limits are per-user. If you go with admin-only configuration <a href="./contact.html">get in touch</a> to figure out what quota limits you&#39;ll be working with.</li>
<li>Get events<ul class="list">
<li>Use an SDK if available to handle querying for events if you don&#39;t have specific needs for unusual queries.</li>
<li>Make requests to the API directly for full control over when and how you&#39;re getting events</li>
</ul>
</li>
<li>Use Storage API for handling files.</li>
<li>Implement resetting your recent event id when you get a 404 for it (see below)</li>
<li>Bake your integration and send it for certification.</li>
</ol>
<h3 id="event-types"><a class="header-link" href="#event-types"></a>Event types</h3>
<p>Events API returns events from file system only. You can detect file and folder operations and adding comments to files, but you won&#39;t detect users or settings modifications.</p>
<h3 id="resetting-last-event-id-(cursor)"><a class="header-link" href="#resetting-last-event-id-(cursor)"></a>Resetting last event id (cursor)</h3>
<p>If you&#39;re polling the events API based on last known event id, effectively saying &quot;give me all events that happened after <code>id</code>&quot; it&#39;s possible that there were 300K events outside of the folder you&#39;re watching while you didn&#39;t get a single one, or there may not be an event in your watched folder for a month. In that case, the request will start failing as soon as the event with your saved <code>id</code> doesn&#39;t exist anymore.</p>
<p>Your reaction should be to query the <code>/cursor</code> endpoint and make a new request with <code>oldest_event_id</code> as your last known event.</p>
<h3 id="tips"><a class="header-link" href="#tips"></a>Tips</h3>
<ul class="list">
<li>Only latest 300000 events are available through Events API. Also, events older than 30 days may be garbage-collected before the limit of 300K is reached</li>
<li>If you want to use Events API for auditing what&#39;s happening, you can&#39;t poll too rarely, some customers burn through the limit of 300K events in less than a week</li>
<li>If you want to show latest activity from a folder in your app&#39;s related view, you can query for events by date instead of getting the cursor</li>
<li>If you&#39;re building for scale and expect your client to keep listening to events for multiple folders and domains, vary your polling interval. Your interval should gradually become longer when there&#39;s no events and reset to short interval when you notice activity. Related reading: <a href="https://en.wikipedia.org/wiki/Exponential_backoff">Exponential backoff</a></li>
</ul>
        </article>
        <div class="nav">
            <a href="index.html" class="back-to-main">&#11188; Back to Table of Contents</a>
            <a href="#top"> &#11192; Back to top</a>
        </div>
    </div>
    <script src="assets/js/test.js"></script>
</body>

</html>
